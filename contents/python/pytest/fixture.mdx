---
title: 夹具
---

夹具（fixtures）是 pytest 的其核心功能之一，用于为测试提供共享的资源、设置或数据。夹具可以帮助你避免重复代码，使测试更加模块化和可维护。pytest 的夹具是一个强大的工具，可以帮助你：
* 共享测试资源。
* 实现初始化和清理操作。
* 参数化测试数据。
* 依赖其他夹具


夹具的本质就是依赖注入（Dependency Injection），通过将依赖项注入到测试函数中，这种反转控制（IoC）的方式使得你的代码更加解耦和复用。


## 来个例子
```py
import pytest

# 定义一个夹具
@pytest.fixture()
def my_fixture(): # 记住这个夹具名
    print("我的测试夹具")
    return 123

# 通过装饰器的方式使用夹具
@pytest.mark.usefixtures("my_fixture")
def test_fix():
    print("我是测试用例")
```

`pytest test.py -vs` 执行后输出如下
```bash
=== test session starts ===
platform darwin -- Python 3.14.1, pytest-9.0.1, pluggy-1.6.0
cachedir: .pytest_cache
rootdir: /Users/admin/py-demo
collected 1 item                                       

test.py::test_fix 我的测试夹具
我是测试用例
PASSED

=== 1 passed in 0.00s ===
```

## 夹具的定义
上边只是夹具的一种定义方式，夹具还有其它定义方式，如下
```py

```

## 夹具返回值
夹具可以返回值，这个返回值可以在测试函数中使用，运行如下代码 `pytest test.py`
```py
import pytest

# 定义一个夹具
@pytest.fixture()
def my_fixture():
    return 123

# 通过参数的方式使用夹具
def test_fix(my_fixture):
    assert my_fixture == 123
```


https://blog.csdn.net/weixin_57805858/article/details/131286735