---
title: æ‰§è¡Œä¸å‚æ•°
---
## ä¸€äº›å‚æ•°
pytestæ‰§è¡Œçš„æ—¶å€™ï¼Œæ”¯æŒä¸€äº›å‚æ•°å¼€å¯ç‰¹å®šåŠŸèƒ½

å¥½çš„ï¼ä»¥ä¸‹æ˜¯ pytest å¸¸ç”¨å‘½ä»¤è¡Œå‚æ•°çš„è¯¦ç»†è¡¨æ ¼è¯´æ˜ï¼š

### ğŸ” **è¾“å‡ºè¯¦ç»†ç¨‹åº¦æ§åˆ¶**

| å‚æ•° | å…¨ç§° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `-v` | `--verbose` | **è¯¦ç»†æ¨¡å¼**ï¼Œæ˜¾ç¤ºæ¯ä¸ªæµ‹è¯•çš„è¯¦ç»†ç»“æœ | `pytest -v` |
| `-q` | `--quiet` | **é™é»˜æ¨¡å¼**ï¼Œåªæ˜¾ç¤ºæ€»ä½“ç»“æœ | `pytest -q` |
| `-s` | `--capture=no` | **ç¦ç”¨æ•è·**ï¼Œæ˜¾ç¤ºprintè¾“å‡ºå’Œæ—¥å¿— | `pytest -s` |
| `-vs` | ç»„åˆå‚æ•° | **è¯¦ç»†+æ˜¾ç¤ºè¾“å‡º**ï¼ˆå¸¸ç”¨ç»„åˆï¼‰ | `pytest -vs` |
| `--tb=style` | `--traceback=style` | **è®¾ç½®å›æº¯æ˜¾ç¤ºæ ·å¼** | `pytest --tb=short` |

**--tb æ ·å¼é€‰é¡¹ï¼š**
- `--tb=auto`ï¼šé»˜è®¤ï¼Œåªæ˜¾ç¤ºå¤±è´¥æµ‹è¯•çš„å›æº¯
- `--tb=short`ï¼šç®€çŸ­çš„å›æº¯ä¿¡æ¯
- `--tb=long`ï¼šè¯¦ç»†å›æº¯ä¿¡æ¯
- `--tb=line`ï¼šæ¯ä¸ªå¤±è´¥åªæ˜¾ç¤ºä¸€è¡Œ
- `--tb=no`ï¼šä¸æ˜¾ç¤ºå›æº¯ä¿¡æ¯

### ğŸ¯ **æµ‹è¯•é€‰æ‹©ä¸è¿‡æ»¤**

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `-k "è¡¨è¾¾å¼"` | **å…³é”®å­—è¿‡æ»¤**ï¼Œè¿è¡Œåç§°åŒ¹é…è¡¨è¾¾å¼çš„æµ‹è¯• | `pytest -k "login"` |
| `-m "æ ‡è®°"` | **æ ‡è®°è¿‡æ»¤**ï¼Œè¿è¡Œæœ‰ç‰¹å®šæ ‡è®°çš„æµ‹è¯• | `pytest -m "slow"` |
| `--lf` | **åªè¿è¡Œä¸Šæ¬¡å¤±è´¥çš„æµ‹è¯•** | `pytest --lf` |
| `--ff` | **å…ˆè¿è¡Œå¤±è´¥çš„ï¼Œå†è¿è¡Œå…¶ä»–çš„** | `pytest --ff` |
| `-x` | **é‡åˆ°ç¬¬ä¸€ä¸ªå¤±è´¥å°±åœæ­¢** | `pytest -x` |
| `--maxfail=n` | **næ¬¡å¤±è´¥ååœæ­¢** | `pytest --maxfail=3` |
| `--ignore=è·¯å¾„` | **å¿½ç•¥æŒ‡å®šè·¯å¾„** | `pytest --ignore=tests/old/` |

### ğŸ“ **ç›®å½•ä¸æ–‡ä»¶æŒ‡å®š**

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `è·¯å¾„/æ–‡ä»¶` | **æŒ‡å®šæµ‹è¯•è·¯å¾„æˆ–æ–‡ä»¶** | `pytest tests/` |
| `::` | **æŒ‡å®šå…·ä½“æµ‹è¯•å‡½æ•°/ç±»** | `pytest test_file.py::test_func` |
| `--collect-only` | **åªæ”¶é›†æµ‹è¯•ï¼Œä¸æ‰§è¡Œ** | `pytest --collect-only` |
| `--pyargs` | **ä»PythonåŒ…å¯¼å…¥æµ‹è¯•** | `pytest --pyargs mypkg.tests` |

### âš™ï¸ **æ‰§è¡Œæ§åˆ¶**

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `-n NUM` | **å¹¶è¡Œæ‰§è¡Œ**ï¼ˆéœ€pytest-xdistï¼‰ | `pytest -n 4` |
| `--looponfail` | **å¤±è´¥æ—¶å¾ªç¯è¿è¡Œ** | `pytest --looponfail` |
| `-p` | **æå‰åŠ è½½æ’ä»¶** | `pytest -p myplugin` |
| `--fixtures` | **æ˜¾ç¤ºå¯ç”¨fixtures** | `pytest --fixtures` |

### ğŸ“Š **æŠ¥å‘Šä¸è¾“å‡º**

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--durations=N` | **æ˜¾ç¤ºæœ€æ…¢çš„Nä¸ªæµ‹è¯•** | `pytest --durations=10` |
| `--junitxml=è·¯å¾„` | **ç”ŸæˆJUnit XMLæŠ¥å‘Š** | `pytest --junitxml=report.xml` |
| `--html=è·¯å¾„` | **ç”ŸæˆHTMLæŠ¥å‘Š**ï¼ˆéœ€pytest-htmlï¼‰ | `pytest --html=report.html` |
| `--cov=æºè·¯å¾„` | **ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š**ï¼ˆéœ€pytest-covï¼‰ | `pytest --cov=myapp` |
| `--lf` | **ä¸Šæ¬¡å¤±è´¥ä¼˜å…ˆ** | `pytest --lf` |

### ğŸ”§ **é…ç½®ä¸è°ƒè¯•**

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `-c æ–‡ä»¶` | **æŒ‡å®šé…ç½®æ–‡ä»¶** | `pytest -c pytest.ini` |
| `--version` | **æ˜¾ç¤ºpytestç‰ˆæœ¬** | `pytest --version` |
| `-h` / `--help` | **æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯** | `pytest -h` |
| `--setup-show` | **æ˜¾ç¤ºfixtureæ‰§è¡Œè¿‡ç¨‹** | `pytest --setup-show` |
| `-l` | **æ˜¾ç¤ºå±€éƒ¨å˜é‡å€¼** | `pytest -l` |
---

 ğŸ¯ **å¸¸ç”¨ç»„åˆç¤ºä¾‹**

```bash
# æœ€å¸¸ç”¨çš„ç»„åˆï¼šè¯¦ç»†è¾“å‡º + æ˜¾ç¤ºæ‰“å°ä¿¡æ¯
pytest -vs

# è¯¦ç»†è¾“å‡º + åªè¿è¡Œåç§°åŒ…å«"api"çš„æµ‹è¯•
pytest -v -k "api"

# è¿è¡Œç‰¹å®šæ–‡ä»¶ä¸­çš„ç‰¹å®šæµ‹è¯•ç±»
pytest test_api.py::TestLogin -vs

# å¹¶è¡Œè¿è¡Œ + ç®€çŸ­å›æº¯ + è¦†ç›–ç‡
pytest -n auto --tb=short --cov=myapp

# å¼€å‘æ—¶çš„å¿«é€Ÿåé¦ˆå¾ªç¯
pytest -xvs --tb=short --lf

# ç”ŸæˆHTMLæŠ¥å‘Š
pytest -v --html=report.html --self-contained-html
```
---
ğŸ“ **é…ç½®æ–‡ä»¶ä¸­çš„å¯¹åº”è®¾ç½®**

è¿™äº›å‚æ•°ä¹Ÿå¯ä»¥åœ¨ `pytest.ini` ä¸­é…ç½®ï¼Œpytestè¿è¡Œçš„æ—¶å€™ä¼šè¯»å–æ­¤æ–‡ä»¶ï¼Œè¿™æ ·å°±ä¸ç”¨è‡ªå·±æ¯æ¬¡å»æ‰‹åŠ¨åŠ å‚æ•°äº†ï¼š

```ini
[pytest]
# ç›¸å½“äºå‘½ä»¤è¡Œ -v
addopts = -v

# ç›¸å½“äº -x
xfail_strict = true

# ç›¸å½“äº --tb=short
addopts = --tb=short

# ç›¸å½“äº -m
markers =
    slow: marks tests as slow
    fast: marks tests as fast
```

---
ğŸ’¡ **ä½¿ç”¨å»ºè®®**

1. **å¼€å‘è°ƒè¯•æ—¶**ï¼š`pytest -xvs`ï¼ˆå¿«é€Ÿå¤±è´¥+è¯¦ç»†è¾“å‡ºï¼‰
2. **CI/CDä¸­**ï¼š`pytest --tb=short --junitxml=report.xml`ï¼ˆç®€æ´+æŠ¥å‘Šï¼‰
3. **æ€§èƒ½åˆ†æ**ï¼š`pytest --durations=10`ï¼ˆæ‰¾å‡ºæ…¢æµ‹è¯•ï¼‰
4. **å¤§å‹é¡¹ç›®**ï¼š`pytest -n auto`ï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰

è¿™äº›å‚æ•°å¯ä»¥æ ¹æ®å®é™…éœ€è¦çµæ´»ç»„åˆä½¿ç”¨ï¼

## ç¼–ç¨‹æ–¹å¼è°ƒç”¨
pytesté™¤äº†æ”¯æŒcliæ–¹å¼è°ƒç”¨ä¹‹å¤–ï¼ˆ`pytest xxx.py`ï¼‰ï¼Œè¿˜æ”¯æŒä¸€ç¼–ç çš„æ–¹å¼è°ƒç”¨
```py
import pytest

if __name__ == "__main__": # è¿è¡Œæµ‹è¯•çš„ä¸»å…¥å£ï¼ˆè¿™ä¸€è¡Œå¯é€‰ï¼‰
    # __file__æ˜¯pythonå†…ç½®çš„å˜é‡ï¼Œä»£æŒ‡å½“å‰æ–‡ä»¶
    pytest.main([__file__, "-v", "-s"]) 
```


