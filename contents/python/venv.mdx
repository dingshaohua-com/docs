---
title: 虚拟环境
---




## 全局污染

Python 的包管理方式和 Java/Node等不一样，这让从其它语言转来的开发者感到困惑。

- **Python** 诞生较早（1991年），当时"一个系统一个Python"是主流思想
- **Node.js**（2009年）从设计时就考虑了多项目、多版本的需求
- **Java** 的企业级应用背景决定了它需要严格的依赖隔离

如果没有虚拟环境，就会出现多个项目共用一个全局的Python 环境，导致版本冲突

```bash
# 项目A 需要 Django 2.2
pip install django==2.2

# 项目B 需要 Django 4.0
pip install django==4.0  # 覆盖了 2.2！

# 现在项目A 无法运行了！

```

✅ 使用虚拟环境的解决方案

```bash
# 项目A
python -m venv venv_a
source venv_a/bin/activate
pip install django==2.2  # 只在 venv_a 中

# 项目B
python -m venv venv_b
source venv_b/bin/activate
pip install django==4.0  # 只在 venv_b 中
# 两个项目互不干扰！
```

执行完上述步骤后，你的项目目录应该是这样的：

```
/Users/admin/files.localized/mcode/py-demo/
├── venv/                    # 虚拟环境目录（不要提交到git）
│   ├── bin/
│   │   ├── python          # Python 解释器
│   │   ├── pip            # pip 包管理器
│   │   └── activate       # 激活脚本
│   ├── lib/
│   │   └── python3.x/     # 安装的包都在这里
│   └── pyvenv.cfg
├── （你的其他项目文件）
└── （测试文件等）

```

需要注意的是，以后每次打开新的终端窗口工作时，都需要手动进入虚拟环境
```bash
# 激活虚拟环境
source venv_xx/bin/activate
# 退出虚拟环境
deactivate
```



## 依赖清单
默认情况下，当你安装了一个依赖后 项目并不会生自动生成依赖清单，就会引发一个问题：别人拿到你的代码时，不知道需要安装什么依赖。所以我们每次安装完后，可以手动调用一个命令来生成！

```bash
(venv) pip freeze > requirements.txt

```

这会创建 `requirements.txt` 文件，记录所有已安装的包，方便其他人重现环境，别人只需要执行一下代码即可安装所有依赖。
```bash
pip install -r requirements.txt
```
